String.prototype.format=function(){var e=(!arguments[0]||typeof arguments[0]=="undefined")?"":arguments[0].toString();var d=/(.*?)({(\d+)(:([0-9a-z]+))?})/ig;var c=this.match(d);if(c){for(var b=0,a=c.length;b<a;b++){c[b]=c[b].replace(d,"$1");switch(typeof arguments[parseInt(RegExp.$3)]){case"undefined":c[b]+=RegExp.$2;break;case"number":c[b]+=(isNaN(RegExp.$5)||RegExp.$5=="")?arguments[parseInt(RegExp.$3)]:arguments[parseInt(RegExp.$3)].toString(Math.max(Math.min(Math.round(RegExp.$5),36),2));break;default:c[b]+=arguments[parseInt(RegExp.$3)]}}c.push(this.replace(d,""));return c.join("")}return this};if(typeof Str=="undefined"){Str={}}Str.divideNumber=function(d){var c=Math.ceil(d.length/3);var a="";for(var b=c;b>0;b--){if(d.length-(b-1)*3<=0){left=0}else{left=d.length-(b-1)*3}a+=","+d.substring(left,d.length-b*3)}a=a.substring(1,a.length);return a};String.prototype.getLen=function(){var b=this;if(typeof b=="undefined"){return 0}var a=b.match(/[^\x00-\x80]/g);return(b.length+(!a?0:a.length))};if(typeof Str=="undefined"){var Str={}}Str.trancate=function(d,a,c){c=c||"...";if(d.getLen()<=a){return d}var b=d.replace(/\*/g," ").replace(/[^\x00-\xff]/g,"**");d=d.slice(0,b.slice(0,a).replace(/\*\*/g," ").replace(/\*/g,"").length);d=d.slice(0,d.length-1)+c;return d};var $addEvent=function(f,d,c,a){var e=typeof f=="string"?$E(f):f;if(typeof a=="undefined"){a=false}if(typeof c=="undefined"){c="click"}if(e.addEventListener){e.addEventListener(c,d,a);return true}else{if(e.attachEvent){var b=e.attachEvent("on"+c,d);return true}else{e["on"+c]=d}}};var Url=function(a){a=a||"";this.url=a;this.query={};this.parse()};(function(a){a.prototype={parse:function(b){if(b){this.url=b}this.parseAnchor();this.parseParam()},parseAnchor:function(){var b=this.url.match(/\#(.*)/);b=b?b[1]:null;this._anchor=b;if(b!=null){this.anchor=this.getNameValuePair(b);this.url=this.url.replace(/\#.*/,"")}},parseParam:function(){var b=this.url.match(/\?([^\?]*)/);b=b?b[1]:null;if(b!=null){this.url=this.url.replace(/\?([^\?]*)/,"");this.query=this.getNameValuePair(b)}},getNameValuePair:function(c){var b={};c.replace(/([^&=]*)(?:\=([^&]*))?/gim,function(d,f,e){if(f==""){return}b[f]=e||""});return b},getParam:function(b){return this.query[b]||""},clearParam:function(){this.query={}},setParam:function(b,c){if(b==null||b==""||typeof(b)!="string"){throw new Error("no param name set")}this.query=this.query||{};this.query[b]=c},setParams:function(b){this.query=b},serialize:function(d){var b=[];for(var c in d){if(d[c]==null||d[c]==""){b.push(c+"=")}else{b.push(c+"="+d[c])}}return b.join("&")},toString:function(){var b=this.serialize(this.query);return this.url+(b.length>0?"?"+b:"")+(this.anchor?"#"+this.serialize(this.anchor):"")},getHashStr:function(b){return this.anchor?"#"+this.serialize(this.anchor):(b?"#":"")}}})(Url);var Ijax={arrTaskLists:[],createLoadingIframe:function(){var a=this;if(this.loadFrames!=null){return false}var d="loadingIframe_thread"+Math.ceil(Math.random()*10000);this.loadFrames=d;var c=['<iframe id="'+d+'" name="'+d+'" class="invisible"',' scrolling="no" src=""',' allowTransparency="true" style="display:none;" frameborder="0"'," ></iframe>"].join("");var b=document.createElement("div");b.id="ijax_iframes";b.innerHTML=c;document.body.appendChild(b);if(document.getElementById(a.loadFrames)!=null){loadTimer=null;a.loadingIframe={container:$E(a.loadFrames),isBusy:false};a.loadByList()}},isIjaxReady:function(){if(typeof this.loadingIframe=="undefined"){return false}if(this.loadingIframe.isBusy==false){this.loadingIframe.isBusy=true;return this.loadingIframe}return false},request:function(a,c){var b={};b.url=a;b.option=c||{};this.arrTaskLists.push(b);if(this.loadFrames==null){this.createLoadingIframe()}else{this.loadByList()}},loadByList:function(){if(this.arrTaskLists.length==0){return false}var b=this.isIjaxReady();if(b==false){return false}var c=this.arrTaskLists[0];var a=this;setTimeout(function(){a.loadData(c.url,c.option,b)},10);this.arrTaskLists.shift()},destory:function(){if(this.arrTaskLists.length>0){return}$E(this.loadFrames).callback=null;document.body.removeChild($E("ijax_iframes"));this.loadFrames=null},loadData:function(url,option,loader){var ifm=loader.container;var _self=this,_url="";ifm.callback=function(res){try{res=(typeof res=="string"&&(/\s*{/.test(res)))?eval("("+res+")"):res;if(res.code=="A00000"&&option.onSuccess){option.onSuccess(res.data);_self.destory()}else{option.onError(res)}}catch(e){}loader.isBusy=false;_self.loadByList()};if(option.CACHE){_url=url;for(var key in option.CACHE){_url+="/"+option.CACHE[key]}}else{_url=new Url(url);if(option.GET){for(var key in option.GET){_url.setParam(key,encodeURIComponent(option.GET[key]))}}if(option.POST){if(!$E("IjaxForm")){var oIjaxForm=document.createElement("form");document.body.appendChild(oIjaxForm);oIjaxForm.id="IjaxForm";oIjaxForm.method="post";oIjaxForm.target=ifm.id}else{$E("IjaxForm").innerHTML=""}$E("IjaxForm").action=_url;for(var oItem in option.POST){var oInput=document.createElement("input");oInput.type="hidden";oInput.name=oItem;oInput.value=option.POST[oItem];$E("IjaxForm").appendChild(oInput)}$E("IjaxForm").submit()}}if(!option.POST){ifm.contentWindow.location.replace(_url)}}};var Interface=function(a,b){this.url=a;this.type=b};Interface.prototype={url:null,request:function(b){var d=b.onError;var a=b.onSuccess;var c=this.url.toString();switch(this.type){case"jsload":JsLoad.request(c,b);break;case"ijax":default:Ijax.request(c,b);break}}};var ReqUrl={mark:"http://score.video.qiyi.com/v",initMark:"http://score.video.qiyi.com/f",playList:"http://cache.video.qiyi.com/l",ctgInfo:"http://cache.video.qiyi.com/a",keySearch:"http://search.video.qiyi.com",relevanceSearch:"http://search.video.qiyi.com",search:"http://search.video.qiyi.com"};var Tween={};(function(){var l={simple:function(q,n,o,p){return o*q/p+n},backEaseIn:function(o,n,r,q){var p=1.70158;return r*(o/=q)*o*((p+1)*o-p)+n},backEaseOut:function(q,n,w,v,o,u){var r=1.70158;return w*((q=q/v-1)*q*((r+1)*q+r)+1)+n},backEaseInOut:function(q,n,w,v,o,u){var r=1.70158;if((q/=v/2)<1){return w/2*(q*q*(((r*=(1.525))+1)*q-r))+n}return w/2*((q-=2)*q*(((r*=(1.525))+1)*q+r)+2)+n},bounceEaseOut:function(o,n,q,p){if((o/=p)<(1/2.75)){return q*(7.5625*o*o)+n}else{if(o<(2/2.75)){return q*(7.5625*(o-=(1.5/2.75))*o+0.75)+n}else{if(o<(2.5/2.75)){return q*(7.5625*(o-=(2.25/2.75))*o+0.9375)+n}else{return q*(7.5625*(o-=(2.625/2.75))*o+0.984375)+n}}}},bounceEaseIn:function(o,n,q,p){return q-l.bounceEaseOut(p-o,0,q,p)+n},bounceEaseInOut:function(o,n,q,p){if(o<p/2){return l.bounceEaseIn(o*2,0,q,p)*0.5+n}else{return l.bounceEaseOut(o*2-p,0,q,p)*0.5+q*0.5+n}},strongEaseInOut:function(o,n,q,p){return q*(o/=p)*o*o*o*o+n},regularEaseIn:function(o,n,q,p){return q*(o/=p)*o+n},regularEaseOut:function(o,n,q,p){return -q*(o/=p)*(o-2)+n},regularEaseInOut:function(o,n,q,p){if((o/=p/2)<1){return q/2*o*o+n}return -q/2*((--o)*(o-2)-1)+n},strongEaseIn:function(o,n,q,p){return q*(o/=p)*o*o*o*o+n},strongEaseOut:function(o,n,q,p){return q*((o=o/p-1)*o*o*o*o+1)+n},strongEaseInOut:function(o,n,q,p){if((o/=p/2)<1){return q/2*o*o*o*o*o+n}return q/2*((o-=2)*o*o*o*o+2)+n},elasticEaseIn:function(q,n,w,v,o,u){if(q==0){return n}if((q/=v)==1){return n+w}if(!u){u=v*0.3}if(!o||o<Math.abs(w)){o=w;var r=u/4}else{var r=u/(2*Math.PI)*Math.asin(w/o)}return -(o*Math.pow(2,10*(q-=1))*Math.sin((q*v-r)*(2*Math.PI)/u))+n},elasticEaseOut:function(q,n,w,v,o,u){if(q==0){return n}if((q/=v)==1){return n+w}if(!u){u=v*0.3}if(!o||o<Math.abs(w)){o=w;var r=u/4}else{var r=u/(2*Math.PI)*Math.asin(w/o)}return(o*Math.pow(2,-10*q)*Math.sin((q*v-r)*(2*Math.PI)/u)+w+n)},elasticEaseInOut:function(q,n,w,v,o,u){if(q==0){return n}if((q/=v/2)==2){return n+w}if(!u){var u=v*(0.3*1.5)}if(!o||o<Math.abs(w)){var o=w;var r=u/4}else{var r=u/(2*Math.PI)*Math.asin(w/o)}if(q<1){return -0.5*(o*Math.pow(2,10*(q-=1))*Math.sin((q*v-r)*(2*Math.PI)/u))+n}return o*Math.pow(2,-10*(q-=1))*Math.sin((q*v-r)*(2*Math.PI)/u)*0.5+w+n}};var g=function(n){return n.uniqueID};if(!$IE){g=function(o){try{var n;if(o.getAttribute("uniqueID")==null){n="moz__id"+parseInt(Math.random()*100)+"_"+new Date().getTime();o.setAttribute("uniqueID",n);return n}return o.getAttribute("uniqueID")}finally{n=null}}}function j(o){try{var n=o.constructor.toString().toLowerCase();return n.slice(n.indexOf("function")+9,n.indexOf("()"))}finally{n=null}}function h(r,q){var p,o,n=[];o=q.length;for(p=0;p<o;p++){n[n.length]=parseFloat(r.style[q[p]])}return n}function k(n){return j(n)!="array"?[n]:n}function c(n,t){try{var q=j(n);var u=[],s=[],r,p,o;if(q!="array"){o=f(n);o[1]=t=="opacity"?"":o[1];u=[o[0]];s=[o[1]]}else{p=n.length;for(r=0;r<p;r++){o=f(n[r]);o[1]=t[r]=="opacity"?"":o[1];u[u.length]=o[0];s[s.length]=o[1]}}return[u,s]}finally{q=u=s=r=p=o=null}}function f(o){try{var n=/(-?\d.?\d*)([a-z%]*)/i.exec(o);return[n[1],n[2]?n[2]:"px"]}finally{n=null}}var a={};var e={};function b(p){try{var o=g(p);var n;if(a[o]!=true){n=new d();e[o]={node:p,func:n};a[o]=true;return n}else{return e[o].func}}finally{o=n=null}}function d(){this._timer=null}d.prototype.start=function(v,u,q,t,r,w){this.reset();w=w||{};if(w.end){this._func.end=w.end}if(w.tween){this._func.tween=w.tween}var o=k(u);var n=h(v,o);var p=c(q,o);this._node=v;this._property=o;this._endingvalue=p[0];this._suffixvalue=p[1];this._startvalue=n;this._end=false;this._fps=0;if(t!=null){this._seconds=t}if(l[r]!=null){this._animation=l[r]}this._starttime=new Date().getTime();var s=this;this._timer=setInterval(function(){s.play()},10)};d.prototype.play=function(){var n=this;var s=(new Date().getTime()-this._starttime)/1000;var q,p,o=this._property.length;if(s>this._seconds){s=this._seconds}for(q=0;q<o;q++){p=this._animation(s,this._startvalue[q],this._endingvalue[q]-this._startvalue[q],this._seconds);var r={};r[n._property[q]]=p+n._suffixvalue[q];$setStyle(n._node,r)}this._fps++;this._func.tween();if(s==this._seconds){this.stop()}};d.prototype.stop=function(){clearInterval(this._timer);this._end=true;this._func.end()};d.prototype.reset=function(){clearInterval(this._timer);this._end=false;this._node=null;this._property=[];this._startvalue=[];this._endingvalue=[];this._suffixvalue=[];this._fps=0;this._seconds=0.5;this._animation=l.simple;this._func={end:function(){},tween:function(){}}};function m(s,t,o,r,p,q){var n=b(s);n.start.apply(n,arguments)}m.stop=function(n){b(n).stop()};m.isTween=function(n){return !b(n)._end};Tween=m})();if(Cookie===undefined){var Cookie={}}Cookie.getCookie=function(a){a=a.replace(/([\.\[\]\$])/g,"\\$1");var c=new RegExp(a+"=([^;]*)?;","i");var d=document.cookie+";";var b=d.match(c);if(b){return b[1]||""}else{return""}};if(Cookie===undefined){var Cookie={}}Cookie.setCookie=function(b,f,c,j,e,a){var g=[];g.push(b+"="+escape(f));if(c){var h=new Date();var d=h.getTime()+c*3600000;h.setTime(d);g.push("expires="+h.toGMTString())}if(j){g.push("path="+j)}if(e){g.push("domain="+e)}if(a){g.push(a)}document.cookie=g.join(";")};var TabDom={body:["<div class='title1 titleBg'>","</div>"].join(""),nav:["<span>{0}</span>"].join("")};var Tabs=function(c,a){this.menuLen=0;this.active=null;this.selected=0;c=c||document.body;var b=$C("div");if(this.menuLen<1){c.innerHTML=TabDom.body}this.type=a;this.dom=c;this.navs=getElementByClz(this.dom,"div","title1")[0];return this};Tabs.prototype.newTab=function(b,c,f,d,g){var e=this;if(d){g=g||"titleSpan";var j=$C("span");j.innerHTML=b;j.className=g;this.selected=this.menuLen;e.navs.appendChild(j);return}var h=$C("h2");var a=$C("div");h.id="tab-"+e.type+"-"+this.menuLen;if(this.menuLen==this.selected){h.className="selected";a.style.display="block";e.active=h}else{a.style.display="none"}h.innerHTML=TabDom.nav.format(b);a.id="cnt-"+e.type+"-"+(this.menuLen);e.navs.appendChild(h);e.dom.appendChild(a);if(typeof c!="undefined"){a.innerHTML=c}h.onclick=function(){var k,l;if(e.active){if(e.active==this){return}e.active.className="";k=e.active.id;l=k.match(/\d/g);$E("cnt-"+e.type+"-"+l).style.display="none"}if($IE6){a.style.filter=" alpha(opacity = 0)"}else{a.style.opacity="0"}this.className="selected";Tween(a,"opacity",1,0.5,"simple");a.style.display="block";e.active=h;if(typeof f=="function"){f()}};this.menuLen++;e.nav=h;e.cnt=a};Tabs.prototype.setContent=function(b,a){this.cnt.innerHTML=b;this.cnt.style.width="100%"};var Search=function(){this.url=new Interface(ReqUrl.search)};Search.prototype={relevance:function(b){var a=this;this.url.request({CACHE:b,onSuccess:function(c){a.relevanceSuccess(c)},onError:function(c){alert("err");a.relevanceError(c)}})},search:function(b){var a=this;this.url.request({CACHE:b,onSuccess:function(c){a.searchSuccess(c)},onError:function(c){alert("err");a.searchError(c)}})},suggest:function(b){var a=this;this.url.request({CACHE:b,onSuccess:function(c){a.suggestSuccess(c)},onError:function(c){a.suggestError(c)}})},index:function(b){var a=this;this.url.request({CACHE:b,onSuccess:function(c){a.indexSuccess(c)},onError:function(c){a.indexError(c)}})},indexSuccess:function(a){},indexError:function(a){},searchByCtg:function(b){var a=this;this.url.request({CACHE:b,onSuccess:function(c){a.ctgSuccess(c)},onError:function(c){a.ctgError(c)}})},ctgSuccess:function(a){},ctgError:function(a){}};function SuggestFun(c){var b=this;var a=new Search();var e;var g=[];var d=100;this.suggestParam={url:""};this.setURL=function(j){var h="userSuggest/"+encodeURIComponent(j).replace(/\%/g,"_")+"/"+10+"/";return h};a.suggestSuccess=function(h){var k="",j=$E("navFormList");if($Maxthon){k='<iframe id="j-suggest-iframe" frameBorder="0" style="display:;width:265px;height:0;" ></iframe>'}if(h.length!=0){$E("navFormList").style.display="block";e=suggestDom.format(h[0]);for(i=1;i<h.length;i++){e=e+suggestDom.format(h[i])}}else{$E("navFormList").style.display="none"}$E(c).innerHTML=k+e;if($Maxthon){$E("j-suggest-iframe").style.display="block";$E("j-suggest-iframe").style.height=j.offsetHeight+"px";j.getElementsByTagName("li")[0].style.cssText="margin-top:-"+$E("j-suggest-iframe").style.height}g=$E(c).getElementsByTagName("a");for(i=0;i<g.length;i++){g[i].num=i;g[i].onmouseover=function(){try{g[d].className=""}catch(l){}d=this.num;f(d);return false}}};a.suggestError=function(){$E("navFormList").style.display="none"};$E("suggestText").onkeyup=function(j){var j=j||event;var h=j.keyCode?j.keyCode:j.which;if(this.value!=b.suggestParam.keyWord&&this.value!=""&&(h<106&&h>48||h==13||h==8||h==32)){b.suggestParam.url=b.setURL(this.value);a.suggest(b.suggestParam)}if(h==38){try{g[d].className=""}catch(j){}d<1?(d=g.length-1):(d=(d-1)%g.length);f(d)}if(h==40){try{g[d].className=""}catch(j){}d==100?(d=0):(d=(d+1)%g.length);f(d)}};$E("suggestText").onblur=function(){$E("navFormList").style.display="none"};function f(h){g[h].className="a1";$E("suggestText").value=g[h].innerHTML}}function doLinkEffect(){$E("navFormList").style.display="none"}var suggestDom='<li><a href="#" onclick="doLinkEffect(this);">{0}</a></li>';var SuggestFun=new SuggestFun("navFormList");$addEvent("searchClick",function(){if($E("suggestText").value!=""){var a="http://www.qiyi.com/common/searchresult.html?key="+encodeURIComponent($E("suggestText").value);window.location.href=a}},"click");$addEvent("suggestText",function(a){a=a||window.event;if(a.keyCode!=13){return}if($E("suggestText").value!=""){var b="http://www.qiyi.com/common/searchresult.html?key="+encodeURIComponent($E("suggestText").value);window.location.href=b}},"keydown");function ShowHideObj(e,a,c,d){var b={eventType:e||"mouseover",openClassName:a||"selected",closeClassName:c||"",defaultNum:d||1,array:[]};var g=this;var f=function(l,k,h){if(l&&l.addEventListener){l.addEventListener(k,h,false);return true}else{if(l&&l.attachEvent){var j=l.attachEvent("on"+k,h);return j}}};this.mouseoutHide=false;this.addElement=function(j,k,h){document.getElementById(j).num=b.array.length;document.getElementById(j).childNode=document.getElementById(k);b.array.push(document.getElementById(j));b.defaultNum==b.array.length?(document.getElementById(j).className=b.openClassName,document.getElementById(k)&&(document.getElementById(k).style.display="block"),b.openNode=document.getElementById(j)):(document.getElementById(j).className=b.closeClassName,document.getElementById(k)&&(document.getElementById(k).style.display="none"));b.defaultNum==-1&&(b.openNode=b.array[0]);f(document.getElementById(j),b.eventType,function(){if(h){h()}g.showItem(document.getElementById(j))})};this.showItem=function(h){b.openNode.className=b.closeClassName;b.openNode.childNode&&(b.openNode.childNode.style.display="none");h.className=b.openClassName;h.childNode&&(h.childNode.style.display="block");b.openNode=h;if($IE8){cssText_="visibility:hidden;"}else{cssText_="display:none;"}if(this.mouseoutHide){h.childNode&&(h.childNode.style.cssText="");b.openNode.onmouseover=function(){b.openNode.className=b.openClassName;b.openNode.childNode&&(b.openNode.childNode.style.cssText="")};b.openNode.childNode.onmouseover=function(){b.openNode.className=b.openClassName;b.openNode.childNode&&(b.openNode.childNode.style.cssText="")};b.openNode.onmouseout=function(){b.openNode.className=b.closeClassName;b.openNode.childNode&&(b.openNode.childNode.style.cssText=cssText_)};b.openNode.childNode.onmouseout=function(){b.openNode.className=b.closeClassName;b.openNode.childNode&&(b.openNode.childNode.style.cssText=cssText_)}}}}var showTop1=new ShowHideObj("","a2","a1",-1);if(document.getElementById("topT2")){showTop1.addElement("topT2","topC2");var showTop=new ShowHideObj();showTop.addElement("topTT1","topCC1",function(){resizeIframe()});showTop.addElement("topTT2","topCC2",function(){document.getElementById("topCC2").style.cssText="background:#f2f2da;display:block;"});showTop.addElement("topTT3","topCC3",function(){resizeIframe()});showTop.addElement("topTT4","topCC4",function(){document.getElementById("topCC4").style.cssText="background:#f2f2da;display:block;"})}showTop1.mouseoutHide=true;function resizeIframe(){if($Maxthon){var c=document.getElementById("topC2");if(c){var b=c.getElementsByTagName("div")[0];var d=c.getElementsByTagName("iframe")[0];var a=0;c.style.display="block";c.style.visibility="hidden";a=c.offsetHeight;c.style.visibility="";c.style.display="none";d.style.display="block";if(d){d.style.height=a+"px"}if(b){b.style.marginTop=-a+"px"}}}}resizeIframe();var qiyi={version:"v 1.0.0",author:"Nick",create:"2010-4-15",update:""};Object.extend=function(b,a){for(var c in a){b[c]=a[c]}return b};Object.each=function(c,b){var a=0;for(var d in c){b(c[d],d,a++)}};var $break={};Object.extend(Array.prototype,{_each:function(d,g){var f=[];try{for(var c=0,b=this.length;c<b;c++){var a=d(this[c],c);if(g&&typeof(a)!="undefined"){f.push(a)}}}catch(h){if(h!=$break){throw h}}return f},collect:function(a){return this._each(a,true)},each:function(a){this._each(a,false);return this},include:function(a){return this.index(a)!=-1},index:function(c){for(var b=0,a=this.length;b<a;b++){if(this[b]==c){return b}}return -1},unique:function(){for(var b=0;b<this.length;b++){var c=this[b];for(var a=this.length-1;a>b;a--){if(this[a]==c){this.splice(a,1)}}}return this},del:function(b){var a=this.index(b);if(a>=0&&a<this.length){this.splice(a,1)}return this}});Object.extend(String.prototype,{trim:function(){return this.replace(/^\s+|\s+$/g,"")},byteLength:function(){return this.replace(/[^\x00-\xff]/g,"**").length}});Object.extend(Function.prototype,{bind:function(){var d=arguments[0];var b=[];var a=this;for(var c=1;c<arguments.length;c++){b.push(arguments[c])}return function(){for(var e=0;e<arguments.length;e++){b.push(arguments[e])}return a.apply(d,b)}},bindEvent:function(){var e=this,d=arguments[0],b=[];for(var c=1,a=arguments.length;c<a;c++){b.push(arguments[c])}return function(g){var f=b.concat();f.unshift(g||window.event);return e.apply(d,f)}}});var Class={create:function(){var e=function(){this.initialize.apply(this,arguments)};for(var b=0,a=arguments.length,d;b<a;b++){d=arguments[b];if(d==null){continue}Object.extend(e.prototype,d)}return e}};var userAgent=navigator.userAgent.toLowerCase();qiyi.Browser={version:(userAgent.match(/.+(?:rv|it|ra|ie)[\/: ]([\d.]+)/)||[0,"0"])[1],safari:/webkit/.test(userAgent),opera:/opera/.test(userAgent),webkit:/webkit/.test(userAgent),ie:/msie/.test(userAgent)&&!/opera/.test(userAgent),mozilla:/mozilla/.test(userAgent)&&!/(compatible|webkit)/.test(userAgent),box:{height:(this.ie&&document.body.scrollHeight>document.documentElement.offsetHeight)?document.body.scrollHeiht:document.documentElement.offsetHeight,scrollTop:this.webkit?document.body.scrollTop:document.documentElement.scrollTop,width:document.documentElement.offsetWidth}};qiyi.Element=Class.create({initialize:function(a){this._els=a},attr:function(a,c){if(typeof(c)=="undefined"){var b=this._els[0];switch(a){case"class":return b.className;case"style":return b.style.cssText;default:return b.getAttribute(a)}}else{this._els.each(function(d){switch(a){case"class":d.className=c;break;case"style":d.style.cssText=c;break;default:d.setAttribute(a,c)}});return this}},removeAttr:function(a){this._els.each(function(b){b.removeAttribute(a)});return this},html:function(a){return this.prop("innerHTML",a)},prop:function(a,b){if(typeof(b)=="undefined"){return this._els[0][a]}else{this._els.each(function(c){c[a]=b});return this}},val:function(c){if(typeof(c)=="undefined"){var b=this._els[0];var a=b.tagName.toLowerCase();if(a=="input"){switch(b.type){case"checkbox":case"radio":return b.checked?b.value:null;break}}return b.value}else{return this.prop("value",c)}},css:function(b,e){if(typeof(e)=="undefined"){var c=this._els[0];if(b=="opacity"){if(qiyi.Browser.ie){return c.filter&&c.filter.indexOf("opacity=")>=0?parseFloat(c.filter.match(/opacity=([^)]*)/)[1])/100:1}else{return c.style.opacity?parseFloat(c.style.opacity):1}}else{function d(f){return f.replace(/[A-Z]/g,function(g){return"-"+g.toLowerCase()})}if(window.getComputedStyle){return window.getComputedStyle(c,null).getPropertyValue(d(b))}if(document.defaultView&&document.defaultView.getComputedStyle){var a=document.defaultView.getComputedStyle(c,null);if(a){return a.getPropertyValue(d(b))}if(b=="display"){return"none"}}if(c.currentStyle){return c.currentStyle[b]}return c.style[b]}}else{this._els.each(function(f){if(b=="opacity"){if(qiyi.Browser.ie){f.style.filter="Alpha(Opacity="+e*100+");"}else{f.style.opacity=(e==1?"":""+e)}}else{f.style[b]=e}});return this}},pos:function(f){if(typeof(f)=="undefined"){var b=this._els[0],c=0,h=0,l=document,k=l.documentElement,n=l.body,m=function(o,p){c+=o||0;h+=p||0};if(b.getBoundingClientRect){var e=b.getBoundingClientRect();m(e.left+Math.max(k.scrollLeft,n.scrollLeft)-k.clientLeft,e.top+Math.max(k.scrollTop,n.scrollTop)-k.clientTop)}else{var g=b.offsetParent,d=b.style.position=="fixed",a=b,j=b.parentNode;m(b.offsetLeft,b.offsetTop);while(g){m(g.offsetLeft,g.offsetTop);if(qiyi.Browser.mozilla&&!/^t(able|d|h)$/i.test(g.tagName)||qiyi.Browser.safari){m(b.style.borderLeftWidth,b.style.borderTopWidth)}if(!d&&g.style.position=="fixed"){d=true}a=g.tagName.toLowerCase()=="body"?a:g;g=g.offsetParent}while(j&&j.tagName&&!/^body|html$/i.test(j.tagName)){if(!/^inline|table.*$/i.test(j.style.display)){m(-j.scrollLeft,-j.scrollTop)}if(qiyi.Browser.mozilla&&j.style.overflow!="visible"){m(j.style.borderLeftWidth,j.style.borderTopWidth)}j=j.parentNode}if(qiyi.Browser.mozilla&&a.style.position!="absolute"){m(-n.offsetLeft,-n.offsetTop)}if(d){m(Math.max(k.scrollLeft,n.scrollLeft),Math.max(k.scrollTop,n.scrollTop))}}return{left:c,top:h}}else{this._els.each(function(o){o.style.left=f.left+"px";o.style.top=f.top+"px"});return this}},box:function(){var a=this._els[0],b=this.pos();b.width=a.offsetWidth;b.height=a.offsetHeight;b.bottom=b.top+b.height;b.right=b.left+b.width;return b},on:function(b,c,a){this._els.each(function(d){qiyi.Event.on(d,b,c,a)});return this},un:function(a,b){this._els.each(function(c){qiyi.Event.un(c,a,b)});return this},show:function(a){if(typeof(a)=="string"){this.css("display",a)}else{this.css("display","block")}return this},hide:function(){this.css("display","none");return this},remove:function(){this._els.each(function(a){if(a.parentNode){a.parentNode.removeChild(a)}})},get:function(a){return qiyi.Element.newInstance(this._els[a])},parent:function(){return qiyi.Element.newInstance(this._els[0].parentNode)},data:function(){return this._els[0].getAttribute("data-key")},elements:function(){return this._els},hasClass:function(a){var b=this._els[0];return b.className&&b.className.split(" ").include(a)},addClass:function(a){this._els.each(function(c){var b=[];if(c.className){b=c.className.split(" ");if(!b.include(a)){b.push(a)}}else{b.push(a)}c.className=b.join(" ")});return this},removeClass:function(a){this._els.each(function(d){if(d.className){var b=d.className.split(" "),c=b.index(a);if(c!=-1){b.splice(c,1)}d.className=b.join(" ")}});return this},clearStyle:function(){this._els.each(function(a){a.setAttribute("style","")})},upWithMe:function(a){var c=$.parseSelectorStr(a)[0];var b=this._els.collect(function(d){while(d){if($.isMatchSelector(d,c)){return d}d=d.parentNode}});return qiyi.Element.newInstance(b)},down:function(a){return $(a,this._els)},each:function(c){for(var b=0,a=this._els.length;b<a;b++){c(qiyi.Element.newInstance(this._els[b]),b)}return this},append:function(a){this._els[0].appendChild(a._els[0])}});qiyi.Element.newInstance=function(a){if(a==null){return null}if(a.constructor==Array&&a.length==0){return null}return new qiyi.Element(a.constructor==Array?a:[a])};qiyi.Element.create=function(b,a){var c=this.newInstance(document.createElement(b));if(typeof(a)=="object"&&a!=null){Object.each(a,function(e,f,d){c.attr(f,e)})}return c};window.$=function(g,d){var b=[];var e=typeof(g);if(e=="string"){if(g.charAt(0)=="#"&&g.indexOf(" ")==-1&&g.indexOf(">")==-1){var f=document.getElementById(g.substr(1));b=f?[f]:null}else{var a=$.parseSelectorStr(g),c=null;if(d==null){c=[window]}else{if(d.attr&&d.elements){if(d.elements().length>0){c=d.elements()}else{c=[window]}}else{if(d.constructor==Array){c=d}else{c=[d]}}}a.each(function(l,j){var k;if(l.scopeType==0){c=[document.getElementById(l.itemName)]}else{if(l.scopeType==1){var h=[];c.each(function(q,p){for(var n=0,o=q.childNodes.length;n<o;n++){h.push(q.childNodes[n])}});c=h;if(l.itemName.length>0){c=c.collect(function(o,n){if(o.tagName&&o.tagName.toLowerCase()==l.itemName){return o}})}}else{var h=[];c.each(function(q,p){if(q==window){q=document}var r=q.getElementsByTagName(l.itemName||"*");for(var n=0,o=r.length;n<o;n++){h.push(r[n])}});c=h}}if(l.propName!=""){var m=l.propValue.length>0;c=c.collect(function(p,o){var n=l.propName=="class"?p.className:p.getAttribute(l.propName);if(n==null){return}if(m){if(l.propName=="class"){n=" "+n+" ";if(n.indexOf(" "+l.propValue+" ")!=-1){return p}}else{if(n==l.propValue){return p}}}else{return p}})}});b=c}}else{if(g.attr){return g}else{if(e=="object"){b=g}else{return null}}}return qiyi.Element.newInstance(b)};$.parseSelectorStr=function(c){var b=[];var a=c.split(" ");a.each(function(f,e){var d=f.split(">");d.each(function(k,h){var g=(h==0)?2:1,n="",m="",o="";var l=k.indexOf(".");if(l!=-1){m="class";o=k.substr(l+1);k=k.substr(0,l)}else{l=k.indexOf("[");if(l!=-1){m=k.substring(l+1,k.length-1).split("=");k=k.substr(0,l);if(m.length==2){o=m[1]}m=m[0]}}if(k.length>0){var p=k.charAt(0);switch(p){case"*":g=2;break;case"#":g=0;n=k.substr(1);break;default:n=k;break}}b.push({scopeType:g,itemName:n,propName:m,propValue:o})})});return b};$.isMatchSelector=function(b,e){var b=$(b);if(!b){return false}b=b.elements()[0];var d=e.itemName,c=e.propName,f=e.propValue;if(e.scopeType==0){if(b.id!=d){return false}}if(d!=""){if(!b.tagName||b.tagName.toLowerCase()!=d){return false}}if(c!=""){var g=f.length>0,a=e.propName=="class"?b.className:(b.getAttribute?b.getAttribute(e.propName):null);if(a==null){return false}if(g){if(c=="class"){a=" "+a+" ";if(a.indexOf(" "+f+" ")==-1){return false}}else{if(a!=f){return false}}}}return true};qiyi.Event={on:function(b,a,c){if(!b||!a||!c){return this}if(b.addEventListener){b.addEventListener(a,c,false)}else{b.attachEvent("on"+a,c)}return this},un:function(b,a,c){if(!b||!a||!c){return this}if(b.removeEventListener){b.removeEventListener(a,c,false)}else{b.detachEvent("on"+a,c)}return this}};qiyi.Template=Class.create({initialize:function(a){this.template=a.toString();this.pattern={left:"${",right:"}"};this.regPattern=/(?:^|.|\r|\n)(\$\{(.*?)\})/g},evaluate:function(b){var a="";if(b.constructor==Object){var c=this;a=this.template.replace(this.regPattern,function(d,g,f){var e=d.split(c.pattern.left)[0];if(e&&e=="\\"){return g}if(b[f]!=undefined){return e+b[f]}else{return e}})}return a}});qiyi.log=function(a){if(window.console){console.log(a)}};qiyi.Ajax={request:function(b,a){var c=this._getTransport();a=Object.extend({method:"get",async:true},a||{});if(a.method=="get"&&typeof(a.data)=="string"){b+=(b.indexOf("?")==-1?"?":"&")+a.data;a.data=null}c.open(a.method,b,a.async);if(a.method=="post"){c.setRequestHeader("Content-type","application/x-www-form-urlencoded; charset=UTF-8")}c.onreadystatechange=this._onStateChange.bind(this,c,b,a);c.send(a.data||null);return c},text:function(b,a){a.format="text";return this.request(b,a)},json:function(b,a){a.format="json";return this.request(b,a)},xml:function(b,a){a.format="xml";return this.request(b,a)},_getTransport:function(){if(window.XMLHttpRequest){return new XMLHttpRequest()}else{try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(a){try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(a){return false}}}},_onStateChange:function(trans,url,options){if(trans.readyState==4){var s=trans.status;if(!!s&&s>=200&&s<300){if(typeof(options.success)!="function"){return}var ctt=trans;if(typeof(options.format)=="string"){switch(options.format){case"text":ctt=trans.responseText;break;case"json":ctt=eval("("+trans.responseText+")");break;case"xml":ctt=trans.responseXML;break}}options.success(ctt)}else{if(window.closed){return}if(typeof(options.failure)=="function"){options.failure(trans)}}}}};qiyi.Cookie={get:function(a){var b,c=new RegExp("(^| )"+a+"=([^;]*)(;|$)","gi");if(b=c.exec(unescape(document.cookie))){return(b[2])}return null},set:function(b,d,a,e,c){var g=b+"="+escape(d);if(a){if(a=="never"){a=100*365*24*60}var f=new Date();f.setTime(f.getTime()+a*60*1000);g+="; expires="+f.toGMTString()}if(e){g+="; path="+e}if(c){g+="; domain="+c}document.cookie=g},remove:function(a,c,b){document.cookie=a+"="+((c)?"; path="+c:"")+((b)?"; domain="+b:"")+"; expires=Thu, 01-Jan-70 00:00:01 GMT"}};$reg=function(e,c){var d=e.split("."),a=window;while(d.length>0){var b=d.shift();qiyi.log(b);if(!a[b]){a[b]={}}a=a[b]}c()};$reg("qiyi.PlayHistory",function(){var a=qiyi.PlayHistory;a.KEY="Q00211";a.DOMAIN="qiyi.com";a.PATH="/";a.videoId=null;a.EMPTY="暂无播放记录";a.boxTpl=['<div class="topCBg">','<p class="pRight">','<a data-key="clear" href="javascript:void(0)">清空记录</a> | <a href="javascript:void(0)" class="fOrange" data-key="close">关闭</a>',"</p>",'<ul class="topC_ulList"></ul>','</div><div class="topCBottomBg"></div>'].join("");a.listTpl='<li><a data-key="${id}" class="shutdown" style="z-index:10" href="javascript:void(0)"></a> <a href="${link}">${title}</a><br/>${info}</li>';a.view={init:function(b){this.data=b.data||[a.EMPTY];this.bar=$(b.bar),this.list=$(b.list);this.list.css("display","");this.initView();this.list.css("visibility","hidden")},setData:function(b){this.data=b||[a.EMPTY]},initView:function(){var g=[],d="",b={},f=new qiyi.Template(a.listTpl);if($Maxthon){d='<iframe style="width:223px;height:0;maring:0;padding:0;overflow:hidden;" frameBorder="0"></iframe>'+a.boxTpl}else{d=a.boxTpl}this.list.html(d);for(var c=0;c<this.data.length;c++){var e=this.data[c];if(e.id&&!b[e.id]){b[e.id]=true;e.info=this.getInfo(e);g.push(f.evaluate(e))}}if(g.length>5){this.list.addClass("topC1")}else{if(g.length==0){g=[a.EMPTY]}this.list.removeClass("topC1")}this.list.down("ul").html(g.join(""));this.currentHeight=this.list.box().height;this.setMaxthon(g.length)},setMaxthon:function(c,d){if($Maxthon){var b=$("#topC1").elements()[0].offsetHeight;if(d>0){b=b-d}else{if(d<0){b=70}}if(c&&c>5){b+=20}this.list.down("div.topCBg").css("marginTop",-b+"px");this.list.down("iframe").css("height",b+"px");this.list.down("iframe").css("width","223px")}},getInfo:function(b){var e=parseInt(b.time)/3600,d=(e-Math.floor(e))*60,c=Math.floor(e),g=Math.floor(d),f="";if(b.title==info.videoName){f="正在播放..."}else{if(b.time==0){f='已看完！ <a href="'+b.link+'" class="jixuLink">重新观看</a>'}else{f="观看至";if(c){f+=c+"小时"}if(g){f+=g+"分"}f+=' <a href="'+b.link+'" class="jixuLink">继续观看</a>'}}return f},show:function(){this.bar.attr("class","a2");this.list.css("visibility","visible")},del:function(c){var b=$(c).parent(),d=b.box().height;b.remove();setTimeout(function(){this.setMaxthon(null,d)}.bind(this),100)},clean:function(){this.list.down("ul").html(a.EMPTY);this.list.removeClass("topC1");this.setMaxthon(null,-1)},hide:function(){this.bar.attr("class","a1");this.list.css("visibility","hidden")}};a.model={getData:function(b){var c=qiyi.Cookie.get(a.KEY);if(c){return this.formatData(c,b)}return null},formatData:function(f,c){var b=f.split("|"),e=[],d={};b.each(function(g){if(g){var h=g.split("*");if(c&&c.except!=h[0]){e.push({title:h[0],link:h[1],time:h[2],id:h[3]})}else{if(!c){e.push({title:h[0],link:h[1],time:h[2],id:h[3]})}}}});this.datalength=b.length;return e},getViewData:function(){if(info&&info.videoId){var b=this.getData({except:info.videoName}),c=[{title:info.videoName,time:-1,id:info.videoId-1,link:"javascript:void(0)"}];if(b){if(b.length>9){b.length=9}return c.concat(b)}return c}else{return this.getData()}},del:function(d){var b=this.getData(),c=[];if(b){b.each(function(e,f){_id=e.id;if(_id!=d){c.push([e.title,e.link,e.time,e.id].join("*"))}});qiyi.Cookie.set(a.KEY,c.join("|"),(60*24*365),a.PATH,a.DOMAIN)}},saveData:function(f,c){var b=info.videoId;info.id=f,record={};if(b){var d=(qiyi.Cookie.get(a.KEY)||""),j=d.split("|"),k=[],g=[info.videoName,info.curtentUrl||location.pathname,c,f].join("*");for(var e=0;e<j.length;e++){var h=j[e].split("*");if(j[e]!=""&&h[0].trim()!=info.videoName.trim()){if(!record[h[3]]){k.push(j[e]);record[h[3]]=true}}}if(k.length>=10){k.length=9;k=[g].concat(k)}else{if(k.length>0){k=[g].concat(k)}else{k=[g]}}qiyi.log(k);qiyi.Cookie.set(a.KEY,k.join("|"),(60*24*365),a.PATH,a.DOMAIN)}},clean:function(){qiyi.Cookie.remove(a.KEY,a.PATH,a.DOMAIN)}};a.ctrl={init:function(){this.flag=0;this.initStartView();this.initEvent();this.out={bar:true,panel:true};this.over={}},initStartView:function(){var b=a.model.getViewData();this.initView({data:b,bar:"#topT1",list:"#topC1"})},initView:function(b){a.view.init(b)},initEvent:function(){var b=a.view;b.bar.on("mouseover",this.barOver.bind(this));b.bar.on("mouseout",this.barOut.bind(this));b.list.on("mouseover",this.panelOver.bind(this));b.list.on("mouseout",this.panelOut.bind(this));b.list.on("click",this.mouseEvent.bindEvent(this))},barOut:function(){this.out.bar=true;this.hide()},panelOut:function(){this.out.panel=true;this.hide()},barOver:function(){this.over.bar=true;a.view.show()},panelOver:function(){this.over.panel=true;a.view.show()},hide:function(){if(this.out.bar&&this.out.panel){a.view.hide()}},saveData:function(d,c){qiyi.log(d+"__"+c);a.model.saveData(d,c);setTimeout(function(){a.view.setData(a.model.getData());a.view.initView()}.bind(this),100)},mouseEvent:function(d){var f=d.target||d.srcElement,b=f.tagName,c=f.getAttribute("data-key");switch(c){case"clear":a.model.clean();a.view.clean();break;case"close":a.view.hide();break;case"del":a.view.del(d);a.model.del(d.getAttribute("data-key"));break;default:if(c){qiyi.log(c);a.view.del(f);a.model.del(c)}break}}};a.next=function(b,h,g,f,e){info.videoName=h;info.title=h;info.videoId=b;for(var d=0,c=info.playlist.length;d<c;d++){if(info.playlist[d].videoId==parseInt(b)+1){info.curtentUrl=info.playlist[d].videoUrl}}a.ctrl.initStartView()};a.init=function(){a.ctrl.init()}});$(window).on("load",function(){postVideoId=function(d,c){if(c>=0){qiyi.PlayHistory.ctrl.saveData(d,c)}};qiyi.PlayHistory.init()});function categorySearch(c,b){var a="http://www.qiyi.com/common/typelist.html?category="+encodeURIComponent(c)+"&key="+encodeURIComponent(b);document.location.href=a}function keySearch(b){var a="http://www.qiyi.com/common/searchresult.html?key="+encodeURIComponent(b);document.location.href=a};